<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiệm Hoa Tươi TMT - Gửi Trọn Yêu Thương</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Quicksand', sans-serif; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        .product-image-zoom { transition: transform 0.3s ease-in-out; }
        .group:hover .product-image-zoom { transform: scale(1.05); }
        button:disabled { background-color: #9ca3af; cursor: not-allowed; }
        .quiz-option.selected{ border-color: #ec4899; background-color: #fdf2f8; transform: translateY(-4px);}
    </style>
</head>
<body class="bg-rose-50 text-gray-800">

    <button id="contact-button" class="fixed bottom-5 right-5 bg-pink-500 text-white font-bold p-4 rounded-full shadow-lg z-40 hover:bg-pink-600 transition-transform hover:scale-110">
        <i data-lucide="phone" class="w-8 h-8"></i>
    </button>
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-pink-600">Tiệm Hoa Tươi TMT</h1>
            <p class="text-gray-500 mt-2 text-lg">Nơi mỗi đóa hoa là một lời yêu thương</p>
        </header>
        <div id='quiz-banner' class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-8 rounded-2xl shadow-lg mb-12 text-center">
            <h2 class="text-3xl font-bold mb-3">Chưa biết tặng hoa gì?</h2>
            <p class="text-lg opacity-90 mb-6">Hãy để TMT giúp bạn chọn bó hoa hoàn hảo chỉ trong vài giây!</p>
            <button id="show-quiz-button" class="bg-white text-pink-500 font-bold py-3 px-8 rounded-lg hover:bg-rose-50 transition-colors shadow-md">Bắt đầu ngay!</button>
        </div>
        <div id="special-occasion-banner" class="hidden bg-gradient-to-r from-purple-500 to-pink-500 text-white p-8 rounded-2xl shadow-lg mb-12 text-center">
            <h2 id="occasion-title" class="text-3xl font-bold mb-3"></h2>
            <p id="occasion-desc" class="text-lg opacity-90 mb-6"></p>
            <div id="occasion-product-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
        </div>

        <main class="flex flex-col lg:flex-row gap-12">
            <div class="w-full lg:w-2/3">
                <h2 class="text-3xl font-semibold mb-6 text-gray-700">Bộ Sưu Tập Hoa</h2>
                <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-8"></div>
            </div>

            <aside class="w-full lg:w-1/3">
                <div class="bg-white/80 backdrop-blur-md p-6 rounded-2xl shadow-lg ring-1 ring-black ring-opacity-5 sticky top-8">
                    <h2 class="text-2xl font-semibold mb-6 border-b pb-4 text-gray-700">Giỏ hoa của bạn</h2>
                    <div id="cart-items" class="space-y-4 mb-6 min-h-[100px]">
                        <p id="empty-cart-message" class="text-gray-400">Giỏ hoa đang trống...</p>
                    </div>
                    
                    <div class="border-t pt-4">
                        <div class="flex justify-between items-center text-xl font-bold">
                            <span>Tổng cộng:</span>
                            <span id="total-price" class="text-pink-600">0đ</span>
                        </div>
                        <button id="checkout-button" class="w-full bg-pink-500 text-white font-bold py-3 rounded-lg mt-6 hover:bg-pink-600 transition-colors duration-300 shadow-md" disabled>Thanh toán</button>
                    </div>
                </div>
            </aside>
        </main>
    </div>
    <div id="quiz-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-50"></div>

    <div id="contact-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-sm text-center">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Bạn cần tư vấn?</h2>
                <button onclick="closeContactModal()" class="text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <p class="text-gray-500 mb-6">Đừng ngần ngại, hãy liên hệ với mình nhé :3</p>
            <div class="space-y-4">
                <a href="tel:0932013424" class="flex items-center justify-center w-full bg-pink-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-pink-600 transition-colors">
                    <i data-lucide="phone" class="w-5 h-5 mr-3"></i> Gọi ngay: 0932 013 424
                </a>
                <a href="https://zalo.me/0379602647" target="_blank" class="flex items-center justify-center w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-600 transition-colors">
                    <i data-lucide="message-circle" class="w-5 h-5 mr-3"></i> Chat qua Zalo
                </a>
                <a href="https://www.facebook.com/tuyen.tu.12979431" target="_blank" class="flex items-center justify-center w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors">
                    <i data-lucide="facebook" class="w-5 h-5 mr-3"></i> Facebook của mình!
                </a>
            </div>
        </div>
    </div>
    
    <footer class="text-center my-12 text-gray-400"><p>&copy; 2025 Tiệm Hoa Tươi TMT. Thiết kế bởi Trương Minh Thành :3</p></footer>

    <script>
        // DANH SÁCH HOA
        const hoaTuoi = [
            { id: 1, name: 'Bó Hoa Hồng Đỏ', price: 550000, salePrice: 490000, image: 'images/hoahong.jpg', meaning: 'Biểu tượng của tình yêu nồng cháy, lãng mạn và sự tôn trọng sâu sắc. Hoàn hảo cho các dịp lễ tình nhân, kỷ niệm.' },
            { id: 2, name: 'Bó Hoa Ly Trắng', price: 480000, image: 'images/hoaly.jpg', meaning: 'Tượng trưng cho sự trong trắng, đức hạnh và thanh cao. Thích hợp để tặng mẹ, bạn bè hoặc trong các dịp trang trọng.' },
            { id: 3, name: 'Bó Hoa Hướng Dương', price: 450000, image: 'images/hoahuongduong.jpg', meaning: 'Mang ý nghĩa về sự lạc quan, niềm tin và hy vọng. Là món quà tuyệt vời để chúc mừng tốt nghiệp, khai trương.' },
            { id: 4, name: 'Bó Hoa Cẩm Tú Cầu', price: 620000, image: 'images/camtucau.jpg', meaning: 'Thể hiện lòng biết ơn chân thành và những cảm xúc sâu sắc. Màu sắc hoa có thể thay đổi tùy theo độ pH của đất.' },
            { id: 5, name: 'Bó Tulip Hà Lan', price: 750000, image: 'images/tulip.jpg', meaning: 'Tượng trưng cho sự giàu có, nổi tiếng và một tình yêu hoàn hảo. Mỗi màu tulip lại mang một thông điệp riêng.' },
            { id: 6, name: 'Bó Hoa Cúc Tana', price: 400000, image: 'images/cuctana.jpg', meaning: 'Nhỏ xinh, mộc mạc, mang ý nghĩa "Tình yêu thuở ban đầu" hay một tình bạn trong sáng, bền chặt.' },
            { id: 7, name: 'Bó Hoa Baby Trắng', price: 380000, salePrice: 290000, image: 'images/hoababy.jpg', meaning: 'Biểu tượng của tình yêu tinh khiết, ngây thơ và trong trắng. Thường được dùng làm hoa phụ hoặc một bó hoa riêng.' },
            { id: 8, name: 'Bó Lan Hồ Điệp', price: 1200000, image: 'images/lanhodiep.jpg', meaning: 'Sang trọng và quý phái, tượng trưng cho sự giàu sang, thịnh vượng và vẻ đẹp hoàn mỹ. Món quà đẳng cấp cho đối tác.' },
            { id: 9, name: 'Bó Mẫu Đơn Hồng', price: 850000, image: 'images/maudon.jpg', meaning: 'Biểu tượng cho sự thịnh vượng, sắc đẹp và một cuộc hôn nhân hạnh phúc, viên mãn. Vẻ đẹp kiêu sa, quyến rũ.' },
            { id: 10, name: 'Bó Oải Hương Khô', price: 420000, image: 'images/oaihuong.jpg', meaning: 'Mang ý nghĩa về sự tinh khiết, nhẹ nhàng và tận tâm. Hương thơm thư giãn, tượng trưng cho sự bình yên.' },
            { id: 11, name: 'Bó Cẩm Chướng', price: 390000, salePrice: 290000, image: 'images/camchuong.jpg', meaning: 'Tượng trưng cho niềm tự hào, sắc đẹp và sự ái mộ. Mỗi màu sắc lại mang một thông điệp tình cảm khác nhau.' },
            { id: 12, name: 'Bó Cúc Họa Mi', price: 350000, image: 'images/cuchoami.jpg', meaning: 'Đại diện cho tình yêu thầm lặng, sự trong trắng và tinh khiết của tâm hồn. Vẻ đẹp giản dị, gần gũi.' },
            { id: 13, name: 'Bó Hoa Sen Trắng', price: 500000, image: 'images/hoasen.jpg', meaning: 'Biểu tượng của sự thanh cao, thuần khiết và giác ngộ. Thể hiện sự tôn kính và bình yên trong tâm hồn.' },
            { id: 14, name: 'Bó Cát Tường', price: 460000, image: 'images/cattuong.jpg', meaning: 'Mang ý nghĩa "may mắn", là lời chúc cho sự thuận lợi, viên mãn và hạnh phúc trong cuộc sống.' },
            { id: 15, name: 'Bó Thạch Thảo Tím', price: 370000, image: 'images/thachthao.jpg', meaning: 'Tượng trưng cho một tình yêu chung thủy, không thay đổi và sự nhớ nhung, chờ đợi trong tình yêu.' },
            { id: 16, name: 'Bó Hoa Rum', price: 580000, image: 'images/rum.jpg', meaning: 'Vẻ đẹp của sự thanh lịch, độc đáo và sự trở về của hạnh phúc. Thích hợp cho các không gian hiện đại.' },
            { id: 17, name: 'Bó Đồng Tiền', price: 410000, image: 'images/dongtien.jpg', meaning: 'Tượng trưng cho sự hạnh phúc, tươi vui và tài lộc. Mang lại sự rạng rỡ và năng lượng tích cực.' },
            { id: 18, name: 'Bó Salem Tím', price: 360000, image: 'images/salem.jpg', meaning: 'Là biểu tượng của sự trường tồn và nỗi nhớ không nguôi. Hoa khô giữ được rất lâu, như một kỷ niệm bền vững.' },
            { id: 19, name: 'Bó Mõm Sói', price: 430000, image: 'images/momsoi.jpg', meaning: 'Đại diện cho sức mạnh, sự duyên dáng và có thể là một chút bí ẩn, che giấu. Mang vẻ đẹp độc đáo, rực rỡ.' },
            { id: 20, name: 'Bó Thủy Tiên Trắng', price: 490000, image: 'images/thuytien.jpg', meaning: 'Tượng trưng cho sự tái sinh, khởi đầu mới và lòng tự trọng. Vẻ đẹp tinh khôi, kiêu hãnh và hương thơm nhẹ nhàng.' }
        ];

        let cart = [];
        const formatCurrency = (number) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(number).replace('₫', 'đ');

        const bodyBackgrounds = [
            'https://www.toptal.com/designers/subtlepatterns/uploads/watercolor.png', 
            'https://images.pexels.com/photos/2079438/pexels-photo-2079438.jpeg?auto=compress&cs=tinysrgb&w=1920', 
            'https://images.pexels.com/photos/39517/rose-flower-blossom-bloom-39517.jpeg?auto=compress&cs=tinysrgb&w=1920' 
        ];
        const bannerBackgrounds = [
            'https://images.pexels.com/photos/1166869/pexels-photo-1166869.jpeg?auto=compress&cs=tinysrgb&w=1920', 
            'https://images.pexels.com/photos/931177/pexels-photo-931177.jpeg?auto=compress&cs=tinysrgb&w=1920', 
            'https://images.pexels.com/photos/796620/pexels-photo-796620.jpeg?auto=compress&cs=tinysrgb&w=1920' 
        ];
        const setRandomBackgrounds = () => {
            const quizBanner = document.getElementById('quiz-banner');

            const randomBodyBg = bodyBackgrounds[Math.floor(Math.random() * bodyBackgrounds.length)];
            document.body.style.backgroundImage = `url('${randomBodyBg}')`;
            document.body.style.backgroundSize = 'cover';
            document.body.style.backgroundAttachment = 'fixed'; 

            const randomBannerBg = bannerBackgrounds[Math.floor(Math.random() * bannerBackgrounds.length)];
            quizBanner.style.backgroundImage = `url('${randomBannerBg}')`;
            quizBanner.style.backgroundSize = 'cover';
            quizBanner.style.backgroundPosition = 'center';
        };

        const productGrid = document.getElementById('product-grid');
        const cartItemsContainer = document.getElementById('cart-items');
        const emptyCartMessage = document.getElementById('empty-cart-message');
        const totalPriceElement = document.getElementById('total-price');
        const checkoutButton = document.getElementById('checkout-button');
        const contactModal = document.getElementById('contact-modal');
        const quizModalContainer = document.getElementById('quiz-modal');
        
        const renderProducts = () => {
            productGrid.innerHTML = hoaTuoi.map(product => {
                const priceHTML = product.salePrice
                    ? `<div>
                           <span class="text-lg font-semibold text-red-600">${formatCurrency(product.salePrice)}</span>
                           <span class="text-sm font-light text-gray-500 line-through ml-2">${formatCurrency(product.price)}</span>
                       </div>`
                    : `<span class="text-lg font-semibold text-pink-600">${formatCurrency(product.price)}</span>`;
                
                return `
                <div class="group bg-white/80 backdrop-blur-md rounded-2xl shadow-lg ring-1 ring-black ring-opacity-5 flex flex-col overflow-hidden">
                    <div class="overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-64 object-cover product-image-zoom">
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <h3 class="text-xl font-bold text-gray-800">${product.name}</h3>
                        <p class="text-gray-500 mt-2 text-sm flex-grow">${product.meaning}</p>
                        <div class="flex justify-between items-center mt-4">
                            ${priceHTML}
                            <button onclick="addToCart(${product.id})" class="bg-pink-50 text-pink-600 font-semibold px-4 py-2 rounded-lg hover:bg-pink-100 transition-colors duration-200">
                                Thêm vào giỏ
                            </button>
                        </div>
                    </div>
                </div>`;
            }).join('');
        };

        const renderCart = () => {
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '';
                emptyCartMessage.style.display = 'block';
                checkoutButton.disabled = true;
            } else {
                emptyCartMessage.style.display = 'none';
                checkoutButton.disabled = false;
                cartItemsContainer.innerHTML = cart.map(item => `
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-semibold">${item.name}</p>
                            <p class="text-sm text-gray-500">${formatCurrency(item.price)}</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <button onclick="updateQuantity(${item.cartId}, -1)" class="w-6 h-6 bg-gray-200 rounded-full font-bold flex items-center justify-center">-</button>
                            <span>${item.quantity}</span>
                            <button onclick="updateQuantity(${item.cartId}, 1)" class="w-6 h-6 bg-gray-200 rounded-full font-bold flex items-center justify-center">+</button>
                        </div>
                    </div>`).join('');
            }
            updateTotalPrice();
        };

        const updateTotalPrice = () => {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            totalPriceElement.textContent = formatCurrency(total);
        };

        window.updateQuantity = (cartId, change) => {
            const cartItem = cart.find(item => item.cartId === cartId);
            if (cartItem) {
                cartItem.quantity += change;
                if (cartItem.quantity <= 0) {
                    cart = cart.filter(item => item.cartId !== cartId);
                }
            }
            renderCart();
        };

        window.addToCart = (productId, customName = null) => {
            const product = hoaTuoi.find(p => p.id === productId);
            const priceToAdd = product.salePrice || product.price;
            const finalName = customName || product.name;

            const cartItem = customName ? null : cart.find(item => item.id === productId && !item.customName);

            if (cartItem) {
                cartItem.quantity++;
            } else {
                cart.push({ 
                    ...product, 
                    price: priceToAdd, 
                    quantity: 1, 
                    name: finalName,
                    customName: !!customName, 
                    cartId: Date.now() 
                });
            }
            renderCart();
        };

        window.openContactModal = () => contactModal.classList.remove('hidden');
        window.closeContactModal = () => contactModal.classList.add('hidden');

        let quizAnswers = {};
        const quizSteps = [
            { key: 'occasion', question: 'Bạn mua hoa cho dịp gì hoặc cho ai?', options: ['Tặng người yêu', 'Tặng Mẹ/Gia đình', 'Chúc mừng bạn bè', 'Tặng đối tác'] },
            { key: 'message', question: 'Bạn muốn gửi gắm thông điệp gì?', options: ['Yêu thương nồng cháy', 'Lòng biết ơn', 'Niềm vui & Lạc quan', 'Sự sang trọng'] },
            { key: 'style', question: 'Bạn thích phong cách nào?', options: ['Rực rỡ & nổi bật', 'Nhẹ nhàng & tinh tế', 'Đơn giản & mộc mạc'] }
        ];

        const getFlowerRecommendation = () => {
            const { occasion, message, style } = quizAnswers;

            if (occasion === 'Tặng người yêu' && message === 'Yêu thương nồng cháy') return { product: hoaTuoi.find(p => p.id === 1), customName: "Tình Yêu Vĩnh Cửu" };
            if (occasion === 'Tặng Mẹ/Gia đình' && message === 'Lòng biết ơn') return { product: hoaTuoi.find(p => p.id === 4), customName: "Lời Cảm Ơn Chân Thành" };
            if (occasion === 'Chúc mừng bạn bè' && message === 'Niềm vui & Lạc quan') return { product: hoaTuoi.find(p => p.id === 3), customName: "Nắng Vàng Rực Rỡ" };
            if (occasion === 'Tặng đối tác' && message === 'Sự sang trọng') return { product: hoaTuoi.find(p => p.id === 8), customName: "Thịnh Vượng & Thành Công" };
            if (style === 'Nhẹ nhàng & tinh tế') return { product: hoaTuoi.find(p => p.id === 2), customName: "Nét Đẹp Thuần Khiết" };
            if (style === 'Đơn giản & mộc mạc') return { product: hoaTuoi.find(p => p.id === 6), customName: "Giản Dị Yêu Thương" };
            return { product: hoaTuoi.find(p => p.id === 14), customName: "May Mắn & An Lành" };
        };

        const renderQuizStep = (stepIndex) => {
            if (stepIndex >= quizSteps.length) {
                const recommendation = getFlowerRecommendation();
                const priceToUse = recommendation.product.salePrice || recommendation.product.price;
                quizModalContainer.innerHTML = `
                <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md text-center">
                    <h2 class="text-2xl font-bold text-gray-800">Bó hoa dành cho bạn:</h2>
                    <p class="text-3xl font-bold text-pink-600 my-4">${recommendation.customName}</p>
                    <img src="${recommendation.product.image}" class="w-48 h-48 object-cover rounded-full mx-auto my-4 shadow-lg">
                    <p class="text-gray-600 mb-6">Dựa trên lựa chọn của bạn, <strong>${recommendation.product.name}</strong> là phù hợp nhất!</p>
                    <button id="add-reco-to-cart" class="w-full bg-pink-500 text-white font-bold py-3 rounded-lg mb-2 hover:bg-pink-600">
                        Thêm vào giỏ (${formatCurrency(priceToUse)})
                    </button>
                    <button onclick="closeQuizModal()" class="w-full text-gray-500 font-semibold py-2">Để sau</button>
                </div>`;
                document.getElementById('add-reco-to-cart').addEventListener('click', () => {
                    addToCart(recommendation.product.id, recommendation.customName);
                    closeQuizModal();
                });
                return;
            }
            const step = quizSteps[stepIndex];
            quizModalContainer.innerHTML = `
            <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">${step.question}</h2>
                    <button onclick="closeQuizModal()" class="text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-6 h-6"></i></button>
                </div>
                <div class="space-y-3">
                    ${step.options.map(opt => `<button class="quiz-option w-full text-left p-4 border-2 rounded-lg transition-all" data-value="${opt}">${opt}</button>`).join('')}
                </div>
            </div>`;
            lucide.createIcons();
            document.querySelectorAll('.quiz-option').forEach(btn => {
                btn.addEventListener('click', () => {
                    quizAnswers[step.key] = btn.dataset.value;
                    renderQuizStep(stepIndex + 1);
                });
            });
        };
        window.closeQuizModal = () => quizModalContainer.classList.add('hidden');
        //Event Listener
        document.addEventListener('DOMContentLoaded', () => {
            setRandomBackgrounds();
            renderProducts();
            renderCart();
            
            document.getElementById('contact-button').addEventListener('click', openContactModal);
            document.getElementById('show-quiz-button').addEventListener('click', () => {
                quizAnswers = {};
                renderQuizStep(0); 
                quizModalContainer.classList.remove('hidden');
            });

            document.getElementById('checkout-button').addEventListener('click', () => {
                if (cart.length > 0) {
                    localStorage.setItem('shoppingCart', JSON.stringify(cart));
                    window.location.href = 'thanhtoan.html';
                }
            });
            lucide.createIcons();
        });
    </script>
</body>
</html>